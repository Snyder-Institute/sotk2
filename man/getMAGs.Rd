% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/utils.R
\name{getMAGs}
\alias{getMAGs}
\title{Extract metagene-associated genes (MAGs) from a correlation-network object}
\usage{
getMAGs(object, profiles, noGenes = 200, coefficient = 0.2)
}
\arguments{
\item{object}{A \code{SOSet} object.}

\item{profiles}{A named list of expression matrices. Each matrix should have genes as rows,
samples as columns, and row names corresponding to gene identifiers.}

\item{noGenes}{\code{numeric} Maximum number of top-ranked genes to evaluate as MAG candidates.
Default is 200.}

\item{coefficient}{\code{numeric} Spearman correlation threshold. Genes with correlation strictly greater than
this value are retained. Default is 0.2.}
}
\value{
A nested list of MAGs. The top level is \code{dataName}, then \code{community}, then \code{metagene},
each containing a character vector of retained genes.
}
\description{
Identifies metagene-associated genes (MAGs) for each metagene using a two-step procedure:
\enumerate{
\item Select the top genes ranked by the basis (W) weights for each metagene.
\item For those genes, compute the Spearman correlation between gene expression (per sample)
and the corresponding coefficient (H) usage values (per sample), and keep genes with
correlation greater than a threshold.
}
Source: Tsukahara, T. et al. A transcriptional rheostat couples past activity to future sensory responses. Cell 184, 6326â€“6343.e32 (2021).
}
\examples{
expr <- readRDS("GLASS_exprProfile.RDS")
mags <- getMAGs(soObj, list(GLASS = expr))

}
